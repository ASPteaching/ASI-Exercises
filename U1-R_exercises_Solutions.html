<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Sanchez-Pla">
<meta name="dcterms.date" content="2024-10-14">

<title>Significance and Hypothesis Testing exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="U1-R_exercises_Solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="U1-R_exercises_Solutions_files/libs/quarto-html/quarto.js"></script>
<script src="U1-R_exercises_Solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="U1-R_exercises_Solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="U1-R_exercises_Solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="U1-R_exercises_Solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="U1-R_exercises_Solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="U1-R_exercises_Solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="U1-R_exercises_Solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="U1-R_exercises_Solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-1" id="toc-problem-1" class="nav-link active" data-scroll-target="#problem-1">Problem 1</a>
  <ul class="collapse">
  <li><a href="#paired-samples-with-numerical-values" id="toc-paired-samples-with-numerical-values" class="nav-link" data-scroll-target="#paired-samples-with-numerical-values">Paired samples with numerical values</a></li>
  <li><a href="#paired-samples.-only-signs" id="toc-paired-samples.-only-signs" class="nav-link" data-scroll-target="#paired-samples.-only-signs">Paired samples. Only signs</a></li>
  <li><a href="#independent-samples" id="toc-independent-samples" class="nav-link" data-scroll-target="#independent-samples">Independent samples</a></li>
  <li><a href="#a-hypothesis-testing-approach" id="toc-a-hypothesis-testing-approach" class="nav-link" data-scroll-target="#a-hypothesis-testing-approach">A Hypothesis testing approach</a>
  <ul class="collapse">
  <li><a href="#paired-samples-with-values" id="toc-paired-samples-with-values" class="nav-link" data-scroll-target="#paired-samples-with-values">Paired samples with values</a></li>
  </ul></li>
  <li><a href="#paired-samples-with-signs" id="toc-paired-samples-with-signs" class="nav-link" data-scroll-target="#paired-samples-with-signs">Paired samples with signs</a></li>
  <li><a href="#independent-samples-1" id="toc-independent-samples-1" class="nav-link" data-scroll-target="#independent-samples-1">Independent samples</a></li>
  </ul></li>
  <li><a href="#problem-2" id="toc-problem-2" class="nav-link" data-scroll-target="#problem-2">Problem 2</a>
  <ul class="collapse">
  <li><a href="#a-type-i-error-probability." id="toc-a-type-i-error-probability." class="nav-link" data-scroll-target="#a-type-i-error-probability.">(a) Type I error probability.</a></li>
  <li><a href="#b-plot-the-power-function." id="toc-b-plot-the-power-function." class="nav-link" data-scroll-target="#b-plot-the-power-function.">(b) Plot the power function.</a></li>
  <li><a href="#the-continuity-correction" id="toc-the-continuity-correction" class="nav-link" data-scroll-target="#the-continuity-correction">The continuity correction</a></li>
  </ul></li>
  <li><a href="#problem-4" id="toc-problem-4" class="nav-link" data-scroll-target="#problem-4">Problem 4</a></li>
  <li><a href="#problem-5" id="toc-problem-5" class="nav-link" data-scroll-target="#problem-5">Problem 5</a></li>
  <li><a href="#problem-7" id="toc-problem-7" class="nav-link" data-scroll-target="#problem-7">Problem 7</a>
  <ul class="collapse">
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">(b)</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">(c)</a></li>
  </ul></li>
  <li><a href="#problem-9" id="toc-problem-9" class="nav-link" data-scroll-target="#problem-9">Problem 9</a>
  <ul class="collapse">
  <li><a href="#permutation-tests-with-r" id="toc-permutation-tests-with-r" class="nav-link" data-scroll-target="#permutation-tests-with-r">Permutation tests with R</a></li>
  </ul></li>
  <li><a href="#calculating-the-mean-and-measuring-the-difference" id="toc-calculating-the-mean-and-measuring-the-difference" class="nav-link" data-scroll-target="#calculating-the-mean-and-measuring-the-difference">Calculating the mean and measuring the difference</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="U1-R_exercises_Solutions.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Significance and Hypothesis Testing exercises</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alex Sanchez-Pla </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 14, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="problem-1" class="level1">
<h1>Problem 1</h1>
<p>The following figures (Cushny and Peebles’ data), are quoted quote by R.A. Fisher <span class="math inline">\({ }^{1}\)</span> from a “Student’s” paper, and show the result of an experiment with ten patients on the effect of two supposedly soporific drugs, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, in producing sleep.</p>
<p>The last column gives a controlled comparison of the efficacy of the two drugs as soporifics, (a) Propose and apply a test of significance to help decide if both drugs can be considered to have the same soporific effect. (b) Answer the previous question assuming that the researchers had decide to record only the sign of the difference, but not the numerical value. (c) Answer the first question assuming that soporific A and B were not tested on the same subjects but, instead on two independent (not matched) groups of subjects.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Patient</th>
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">Difference (B - A).</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">+0.7</td>
<td style="text-align: center;">+1.9</td>
<td style="text-align: center;">+1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-0.6</td>
<td style="text-align: center;">+0.8</td>
<td style="text-align: center;">+2.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-0.2</td>
<td style="text-align: center;">+1.1</td>
<td style="text-align: center;">+1.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">-1.2</td>
<td style="text-align: center;">+0.1</td>
<td style="text-align: center;">+1.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-0.1</td>
<td style="text-align: center;">-0.1</td>
<td style="text-align: center;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">+3.4</td>
<td style="text-align: center;">+4.4</td>
<td style="text-align: center;">+1.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">+3.7</td>
<td style="text-align: center;">+5.5</td>
<td style="text-align: center;">+1.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">+0.8</td>
<td style="text-align: center;">+1.6</td>
<td style="text-align: center;">+0.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">0.0</td>
<td style="text-align: center;">+4.6</td>
<td style="text-align: center;">+4.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">+2.0</td>
<td style="text-align: center;">+3.4</td>
<td style="text-align: center;">+1.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Mean <span class="math inline">\((\bar{x})\)</span></td>
<td style="text-align: center;">+0.75</td>
<td style="text-align: center;">+2.33</td>
<td style="text-align: center;">+1.58</td>
</tr>
</tbody>
</table>
<p>Table 1: Additional Hours of Sleep galned by the Use OF TWO TESTED DRUGS</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>drugA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">1.2</span>,<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">3.4</span>,<span class="fl">3.7</span>, <span class="fl">0.8</span>,<span class="dv">0</span>  ,<span class="fl">2.0</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drugB <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.9</span>,<span class="fl">0.8</span> ,<span class="fl">1.1</span>, <span class="fl">0.1</span> ,<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">4.4</span>,<span class="fl">5.5</span>, <span class="fl">1.6</span>,<span class="fl">4.6</span>,<span class="fl">3.4</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>BvsA <span class="ot">&lt;-</span> drugB<span class="sc">-</span>drugA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we compute observed statistics for each test and then the associated p-values we obtain:</p>
<section id="paired-samples-with-numerical-values" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples-with-numerical-values">Paired samples with numerical values</h2>
<p>Here we can state the null hypothesis as: <span class="math inline">\(H_0: \mu_D = 0\)</span></p>
<p>We can rely on a student’s T statistic, tha, as a corollary of Fisher’s Theorem, is known to follow a <span class="math inline">\(t_n-1\)</span> distribution. <span class="math display">\[
\frac{\overline{X}-\mu}{S/\sqrt{n}}\sim t_{n-1}, \text{where: }  S^2=\frac{1}{n-1}\sum_{i=1}^n (X_i-\overline{X})^2.
\]</span></p>
<p>If we compute the observed value of the test statistic yields: <span class="math inline">\(\tilde t_{obs}=3.91\)</span>.</p>
<p>The p-value is defined as <span class="math inline">\(P[T \geq \tilde t_{obs}| H_0] = P[t_{n-1}\tilde t_{obs}| H_0]\)</span></p>
<p>This can be computed in r as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="fl">3.91</span>,<span class="dv">9</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001782377</code></pre>
</div>
</div>
<p>The p-value is very small so it is very unlikely that the observed difference is due to chance which leads us to decide <span class="math inline">\(H_0\)</span> is not acceptable, that is, <em>there is a significant difference between the drugs</em>.</p>
</section>
<section id="paired-samples.-only-signs" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples.-only-signs">Paired samples. Only signs</h2>
<p>Assume we have paired samples and only the signs of the differences</p>
<p>In that case, although we still aim at determining if the drugs have the same effect we can only work with the “number of positive signs”.</p>
<p>The statistic “<span class="math inline">\(\mathrm{N}=\)</span> # of positive signs” in a sample of <span class="math inline">\(n\)</span> observations where the probability of obtaining a positive sign is <span class="math inline">\(p\)</span> follows a binomial distribution:</p>
<p><span class="math display">\[
N_{n, p} \sim B(n, p)
\]</span></p>
<p>Now the null hypothesis can be stated as: <span class="math inline">\(H_{0}: p=1 / 2\)</span> which means that under this null hypothesis</p>
<p><span class="math display">\[
N_{n . p} \sim \operatorname{Bin}(n=10, p=0.5)
\]</span></p>
<p>Now, given that we he observed 9 positive signs, the observed value of the statistic is <span class="math inline">\(\tilde{n}_{\text {obs }}=9\)</span> and the p-value can be computed as:</p>
<p><span class="math display">\[
P\left[N_{n, p} \geq \tilde{n}_{\text {obs }} \mid H_{0}\right]=P\left[N_{10,0.5} \geq \tilde{n}_{\text {obs }}\right]=p(N=9)+p(N=10)
\]</span></p>
<p>This can be computed using R as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p10<span class="ot">&lt;-</span> <span class="fu">dbinom</span>( <span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p9<span class="ot">&lt;-</span> <span class="fu">dbinom</span> (<span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">0.5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>p9<span class="sc">+</span>p10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01074219</code></pre>
</div>
</div>
<p>The p-value is still small (though not so much as in the previous case) so it is unlikely that the observed difference is due to chance which leads us to decide <span class="math inline">\(H_{0}\)</span> is not acceptable, that is, there is a significant difference between the drugs.</p>
<p>Notice that in this case, the strength of evidence against <span class="math inline">\(H_{0}\)</span> reflected by the p-value is smaller, which is reasonable given that we have less information about how the data deviate from the hypothesis.</p>
</section>
<section id="independent-samples" class="level2">
<h2 class="anchored" data-anchor-id="independent-samples">Independent samples</h2>
<p>Assume samples are independent and only the signs of the differences</p>
<p>If for whatever reason the drugs had been tested on distinct patients, the question about if the drugs have the same effect may be re-stated, for instance as: <span class="math inline">\(H_{0}: \mu_{A}=\mu_{B}\)</span>.</p>
<p>In this case we may, again, rely on a statistic whose distribution is known as a corollary of Fisher’s theorem.</p>
<p>Given two independent simple random samples:</p>
<p><span class="math display">\[
X_{1}, X_{2}, \ldots, X_{n_{1}} \stackrel{i i d}{\sim} N\left(\mu_{1}, \sigma_{1}\right) \quad Y_{1}, Y_{2}, \ldots, Y_{n_{2}} \stackrel{i i d}{\sim} N\left(\mu_{2}, \sigma_{2}\right)
\]</span></p>
<p>The statistic</p>
<p><span class="math display">\[
\frac{\bar{X}-\bar{Y}-\left(\mu_{1}-\mu_{2}\right)}{\sqrt{\left(n_{1}-1\right) S_{1}^{2} / \sigma_{1}^{2}+\left(n_{2}-1\right) S_{2}^{2} / \sigma_{2}^{2}}} \sqrt{\frac{n_{1}+n_{2}-2}{\sigma_{1}^{2} / n_{1}+\sigma_{2}^{2} / n_{2}}}
\]</span></p>
<p>is distributed as a Student’s <span class="math inline">\(t\)</span> with <span class="math inline">\(n_{1}+n_{2}-2\)</span> degrees of freedom. Under the assumption that <span class="math inline">\(\sigma_{1}^{2}=\sigma_{2}^{2}\)</span> and <span class="math inline">\(n_{1}=n_{2}, \sigma^{2}\)</span> cancels out and the statistic can be computed for the sample.</p>
<p>Computing the value of the statistic from the sample yields: <span class="math inline">\(\tilde{t}_{\text {obs}}= 1.80\)</span> and using R the p-value can be computed as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span> (<span class="at">q=</span><span class="fl">1.80</span>, <span class="at">df=</span><span class="dv">18</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04432216</code></pre>
</div>
</div>
<p>Notice that this p-value can lead to the temptation to discuss significance with respect to a threshold, which should be avoided! Instead it is preferable to notice that there is not much evidence leading to accept there is a significant difference between the drugs.</p>
</section>
<section id="a-hypothesis-testing-approach" class="level2">
<h2 class="anchored" data-anchor-id="a-hypothesis-testing-approach">A Hypothesis testing approach</h2>
<section id="paired-samples-with-values" class="level3">
<h3 class="anchored" data-anchor-id="paired-samples-with-values">Paired samples with values</h3>
<p><span class="math display">\[
H_0: \mu_D = 0; \quad H_1: \mu_D &gt; 0
\]</span> Student’s T-test is the optimal test for this procedure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(BvsA, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  BvsA
t = 3.9128, df = 9, p-value = 0.001775
alternative hypothesis: true mean is greater than 0
95 percent confidence interval:
 0.7866405       Inf
sample estimates:
mean of x 
     1.48 </code></pre>
</div>
</div>
</section>
</section>
<section id="paired-samples-with-signs" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples-with-signs">Paired samples with signs</h2>
<p><span class="math display">\[
H_0: \# \text{positive signs} = \# \text{negative signs}
\]</span> There is no optimal test for this problem but the signs tests or bintest provides a good approximation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span> (<span class="dv">9</span>,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  9 and 10
number of successes = 9, number of trials = 10, p-value = 0.02148
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.5549839 0.9974714
sample estimates:
probability of success 
                   0.9 </code></pre>
</div>
</div>
</section>
<section id="independent-samples-1" class="level2">
<h2 class="anchored" data-anchor-id="independent-samples-1">Independent samples</h2>
<p>Under the assumption that variances are equal the two-sample t-test provides an optimal solution for this problem</p>
<p><span class="math display">\[
H_0: \mu_A = \mu_B; \quad H_0: \mu_A &lt; \mu_B;
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(drugB,drugA, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  drugB and drugA
t = 1.7964, df = 18, p-value = 0.04461
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 0.05138695        Inf
sample estimates:
mean of x mean of y 
     2.33      0.85 </code></pre>
</div>
</div>
</section>
</section>
<section id="problem-2" class="level1">
<h1>Problem 2</h1>
<section id="a-type-i-error-probability." class="level2">
<h2 class="anchored" data-anchor-id="a-type-i-error-probability.">(a) Type I error probability.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Type.I.error.prob <span class="ot">&lt;-</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> (  <span class="fu">pnorm</span>((<span class="fl">60.5</span> <span class="sc">-</span> n<span class="sc">*</span>p)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span> <span class="fu">pnorm</span>((<span class="fl">39.5</span> <span class="sc">-</span> n<span class="sc">*</span>p)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Type.I.error.prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03572884</code></pre>
</div>
</div>
</section>
<section id="b-plot-the-power-function." class="level2">
<h2 class="anchored" data-anchor-id="b-plot-the-power-function.">(b) Plot the power function.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">01</span>,.<span class="dv">99</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>power.p <span class="ot">&lt;-</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> (  <span class="fu">pnorm</span>((<span class="fl">60.5</span> <span class="sc">-</span> n<span class="sc">*</span>p)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))) </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span> <span class="fu">pnorm</span>((<span class="fl">39.5</span> <span class="sc">-</span> n<span class="sc">*</span>p)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p,power.p,<span class="at">type=</span><span class="st">"l"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>.<span class="dv">5</span>,<span class="at">col=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="U1-R_exercises_Solutions_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-continuity-correction" class="level2">
<h2 class="anchored" data-anchor-id="the-continuity-correction">The continuity correction</h2>
<p>See <a href="https://www.drdawnwright.com/continuity-correction-filling-the-cracks/">this intuitive eplanation</a></p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="problem-4" class="level1">
<h1>Problem 4</h1>
<!-- % de Chiara & Hesterberg, exemple  8.15 -->
<p>A team of researchers plans a study to see if a certain drug can increase the speed at which mice move through a maze. An average decrease of 2 seconds through the maze would be considered effective, so the researchers would like to have a good chance of detecting a change this large or larger. Would 20 mice be a large enough sample? Assume the standard deviation is <span class="math inline">\(\sigma = 3\)</span> sec.&nbsp;and that the researchers will use a significance level of <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<!-- ```{r} -->
<!-- library(ggplot2) -->
<!-- base <- ggplot() + xlim(0, 20) -->
<!-- base + -->
<!--   geom_function(aes(colour = "H0 : speed = 12"), fun = dnorm, args = list(mean = 12, sd = 2)) + -->
<!--   geom_function(aes(colour = "H11: speed = 11"), fun = dnorm, args = list(mean = 11, sd = 2)) + -->
<!--   geom_function(aes(colour = "H12: speed = 10"), fun = dnorm, args = list(mean = 10, sd = 2)) + -->
<!--   geom_function(aes(colour = "H13: speed =  8"), fun = dnorm, args = list(mean = 8, sd = 2)) -->
<!-- ``` -->
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/Exercise_1_2_3.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pow<span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span><span class="dv">20</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">delta=</span><span class="dv">2</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd=</span><span class="dv">3</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">sig.level=</span><span class="fl">0.05</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">power=</span><span class="cn">NULL</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type=</span><span class="st">"one.sample"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">alternative=</span><span class="st">"one.sided"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(pow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 20
          delta = 2
             sd = 3
      sig.level = 0.05
          power = 0.8902459
    alternative = one.sided</code></pre>
</div>
</div>
<p>Notice that ther is a small difference between the analytical solution and the one using the <code>power</code>function because, in the first case we are working with the unrealistic assumption that <span class="math inline">\(\sigma\)</span> is known. The second case (using R) assumes it is unknown and estimated.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="problem-5" class="level1">
<h1>Problem 5</h1>
<!-- % de Chiara & Hesterberg, exemple  8.16 -->
<p>Suppose the researchers in the previous example want a 95% chance of rejecting <span class="math inline">\(H_0:\, \mu = 0\)</span> at <span class="math inline">\(\alpha = 0.01\)</span> if the true change is a 1.5 sec.&nbsp;decrease in time. What is the smallest number of mice that should be included in the study?</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/Exercise_1_2_4a.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/Exercise_1_2_4b.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/Exercise_1_2_4c.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Using R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n=</span><span class="cn">NULL</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">delta=</span><span class="fl">1.5</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sd=</span><span class="dv">3</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">sig.level=</span><span class="fl">0.01</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">power=</span><span class="fl">0.95</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">type=</span><span class="st">"one.sample"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">alternative=</span><span class="st">"one.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 65.82776
          delta = 1.5
             sd = 3
      sig.level = 0.01
          power = 0.95
    alternative = one.sided</code></pre>
</div>
</div>
<p>As in the previous exercise there is adifference in results due to the unrealistic assumption that <span class="math inline">\(\sigma\)</span> is known in the first case.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="problem-7" class="level1">
<h1>Problem 7</h1>
<p>The Poisson distribution is discrete, that’s why we cannot obtain critical regions having an exact significance level of say <span class="math inline">\(\alpha= 0.05\)</span> or <span class="math inline">\(\alpha= 0.01\)</span> , Instead, we iterate the computation until we find the value that defines a critical region with size <span class="math inline">\(\leq \alpha\)</span></p>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">(b)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>(alpha.<span class="fl">0.</span>k <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(k,<span class="dv">10</span>)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.999954600 0.999500601 0.997230604 0.989663949 0.970747312 0.932914037
 [7] 0.869858579 0.779779353 0.667180321 0.542070286 0.416960250 0.303223854
[13] 0.208443524 0.135535577 0.083458473 0.048740403 0.027041610 0.014277614
[19] 0.007186505 0.003454342 0.001588261</code></pre>
</div>
</div>
</section>
<section id="c" class="level2">
<h2 class="anchored" data-anchor-id="c">(c)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>(alpha.<span class="fl">0.</span>k <span class="ot">&lt;-</span> <span class="fu">ppois</span>(k<span class="dv">-1</span>,<span class="dv">10</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4.539993e-05 4.993992e-04 2.769396e-03 1.033605e-02 2.925269e-02
 [6] 6.708596e-02 1.301414e-01 2.202206e-01 3.328197e-01 4.579297e-01</code></pre>
</div>
</div>
<!-- # Problem 9 -->
<!-- ```{r} -->
<!-- x <- seq(-3,3,by=.1) -->
<!-- f1 <- exp(-.5*x^2)/sqrt(2*pi) -->
<!-- f2 <- .5*exp(-abs(x)) -->
<!-- plot(x,f1, ylim=c(0,.5), type="l",  col=4, lwd=2, -->
<!--      ylab = "f(x)", main="Testing N(0,1) against Double Exponential") -->
<!-- lines(x,f2, lty=2, col=3, lwd=2) -->
<!-- x0 <- -1 -->
<!-- lines(c(x0,x0),c(0,exp(-.5*x0^ 2)/(2*pi)^.5), lty=2, col=2, lwd=2) -->
<!-- x0 <- 1 -->
<!-- lines(c(x0,x0),c(0,exp(-.5*x0^ 2)/(2*pi)^.5), lty=2, col=2, lwd=2) -->
<!-- abline(h=0,v=0,col=8) -->
<!-- ``` -->
<!-- ## (b) -->
<!-- ```{r} -->
<!-- eta.0 <- 2*(pnorm(-2)) -->
<!-- eta.1 <- exp(-2) -->
<!-- c(eta.0, eta.1) -->
<!-- ``` -->
<!-- ## (c) -->
<!-- ```{r} -->
<!-- eta.0 <- 1 - 2*(pnorm(3/2)-pnorm(1/2)) -->
<!-- eta.1 <- 1 - (exp(-1/2)-exp(-3/2)) -->
<!-- c(eta.0, eta.1) -->
<!-- ``` -->
</section>
</section>
<section id="problem-9" class="level1">
<h1>Problem 9</h1>
<section id="permutation-tests-with-r" class="level2">
<h2 class="anchored" data-anchor-id="permutation-tests-with-r">Permutation tests with R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">197</span>, <span class="dv">16</span>, <span class="dv">38</span>, <span class="dv">99</span>, <span class="dv">141</span>, <span class="dv">23</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">104</span>, <span class="dv">146</span>, <span class="dv">10</span>, <span class="dv">51</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">27</span>, <span class="dv">46</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We start by computing the <em>oberved difference in means</em></p>
</section>
</section>
<section id="calculating-the-mean-and-measuring-the-difference" class="level1">
<h1>Calculating the mean and measuring the difference</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z) ; <span class="fu">length</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86.85714</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y) ; <span class="fu">length</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56.22222</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(diffMeans0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(z) <span class="sc">-</span> <span class="fu">mean</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30.63492</code></pre>
</div>
</div>
<p>Now, let us perform a two-sided permutation test using the following steps:</p>
<ol type="1">
<li>Let us combine the two datasets into a single dataset.</li>
<li>Randomly assign each data point into either z or y, although we need to maintain the original sample size (n=7) for Z and (n=9) for y.</li>
<li>After randomization, calculate the relevant statistic by taking the difference between mean(Zi) and mean(Yi).</li>
<li>Repeat the steps above until we have 10000 statistics.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">c</span>(z, y) <span class="co"># combines the data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># set seed for reproducibility</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># declaring a vector to contain the null distributions</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># performs randomization at least 100000</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>) {</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  shuffled_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined_data)  <span class="co"># randomly shuffles the data</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  shuffled_z <span class="ot">&lt;-</span> shuffled_data[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="co"># assigns the first seven points to Z</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  shuffled_y <span class="ot">&lt;-</span> shuffled_data[<span class="dv">8</span><span class="sc">:</span><span class="dv">16</span>]  <span class="co"># assigns the last nine points to y</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  null_dist[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(shuffled_z) <span class="sc">-</span> <span class="fu">mean</span>(shuffled_y)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(null_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="U1-R_exercises_Solutions_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ol start="5" type="1">
<li><p>Add the numbers of statistics that are equal to or greater the previously computed difference in means <code>diffMeans0</code>.</p></li>
<li><p>Calculate the p-value of the permutation test by dividing the sum from step 5 by 10000 (the number of randomization performed).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(p_value <span class="ot">&lt;-</span> (<span class="fu">sum</span>(null_dist <span class="sc">&gt;=</span> diffMeans0) <span class="sc">+</span> <span class="fu">sum</span>(null_dist <span class="sc">&lt;=</span> <span class="sc">-</span>diffMeans0))<span class="sc">/</span><span class="fu">length</span>(null_dist))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.28004</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>